---
layout: post
title: "重复代码与侠客行"
description: "为什么人那么执迷于看起来行为如此不一样的两个人，仍然是同一个实体呢？用柏拉图的话说，就是人先验的认为他们是同一个更高级实体的投影，不过避开哲学，有更科学一点的解释，就是我们必须要抽象概念来避免重复，很可能潜在的原因是我们大脑处理能力有限，如果我们没有进化出这种抽象能力，早就被万物万象把大脑给撑爆了"
category: "胡思乱想"
tags: ["软件开发"]
---
{% include JB/setup %}

> 他奔行不到一里之地，便见一块岩石上坐着一人，侧面看去，赫然便是本帮的帮主石破天。云香主等七人在岩前恭恭敬敬的垂手而立。贝海石抢上前去，其时阳光从头顶直晒，照得石上之人面目清晰无比，但见他浓眉大眼，长方的脸膛，却不是石帮主是谁？贝海石喜叫：“帮主，你老人家安好？”

> ……

> ……

> 那少年道：“你从来没跟我说过，我不知道你叫什么？”笑了又笑道：“我不叫少爷，叫做狗杂种，那是我娘这么叫的。老伯伯说这是骂人的话，不好听。你叫什么？”

> 那少女越听越是皱眉，心道：“瞧他说话的模样，全无轻佻玩笑之意，看来他当真是胡涂啦。”不由得心下难过，问道：“少爷，你真的不认得我了？不认得我侍剑了？”那少年道：“你叫侍剑么？好，以后我叫你侍剑……不，侍剑姊姊。我妈说，女人年纪比我大得多的，叫她阿婆、阿姨，和我差不多的，叫她姊姊。”侍剑头一低，突然眼泪滚了出来，泣道：“少爷，你……你不是装假骗我，真的忘了我么？”

----------

看过金庸侠客行的自然知道，这是“狗杂种”被当做了石破天，因为长相神似，在很长一段时间里，长乐帮的众人都不相信“狗杂种”是另一个人，甚至连叮叮当当也看走了眼，这是为什么？

今天Jeff突然问起对重复代码的厌恶源自何处，我的第一反应是来自于对重复代码所产生麻烦的痛苦体验。不过我这样的慢速思考类型所作出的第一反应通常都不那么正确，在几分钟后，我才大致开始摸出方向：大概是对重复概念的天生厌恶。

Jeff说这就是柏拉图的实在论。

柏拉图的形而上学基本概念就是现实形式是至善形式的“投影”，比如马既不是白马，也不是黑马，它代表了“马”这种概念，是先验的一种永恒，而白马，黑马不过是其更低一级的形式投影而已。我感觉，Jeff的意思大概就是说编码是个把低级形式向更高级的抽象形式转化的过程，而如果出现了重复，显然就意味着“不完善”，这自然会让人厌恶，因为这和人头脑中先验的体悟产生了冲突。

如果以哲学这么抽象的语言来描述，我大致也是这样的观点，不过哲学太抽象，描述出来推广意义也不大，我们倒转头来看侠客行的例子，不过以代码的方式，这会非常有趣

    class 狗杂种 {
        face = "浓眉大眼，长方的脸膛"
    }

    class 石破天 {
        face = "浓眉大眼，长方的脸膛"
    }

这是不是重复代码，有没有冲动合二为一？有？那就对了，你这种冲动和长乐帮的帮众，以及叮叮当当一般无二，他们可不是程序员，合并重复后如下：

    class 狗杂种石破天 {
        face = "浓眉大眼，长方的脸膛"
    }

重复代码没有了，心里是不是舒坦很多？继续往后读小说，书中提到狗杂种“全无轻佻玩笑之意”，显然暗示石破天说话全不正经，这个时候我们要怎么办？显然，小说里面的侍剑选择了写出下面的代码：

    class 狗杂种石破天 {
        face = "浓眉大眼，长方的脸膛"
    }

    class 狗杂种石破天_糊涂啦 extends 狗杂种石破天 {
        talk = "全无轻佻玩笑之意"
    }

    class 狗杂种石破天_糊涂前 extends 狗杂种石破天 {
        talk = "轻佻，不正经"
    }

简单而言，就是我还是认为你是石破天，但是你的反常完全是因为糊涂了。为什么人那么执迷于看起来行为如此不一样的两个人，仍然是同一个实体呢？用柏拉图的话说，就是人先验的认为他们是同一个更高级实体的投影，不过避开哲学，有更科学一点的解释，就是我们必须要抽象概念来避免重复，很可能潜在的原因是我们大脑处理能力有限，如果我们没有进化出这种抽象能力，早就被万物万象把大脑给撑爆了。

读过侠客行的各位大概知道后续的发展，虽然金庸没有明说，但位码大致如下

    class 石清夫妇之子 {
        face = "浓眉大眼，长方的脸膛"
    }

    class 狗杂种 extends 石清夫妇之子 {
        talk = "全无轻佻玩笑之意"
    }

    class 石破天 extends 石清夫妇之子 {
        talk = "轻佻，不正经"
    }

虽然整个信息和概念变化很大，但是实体的行为却保持了一致，而且依然没有重复！这可能是因为柏拉图所说的先验的至善帮我们消除了概念上的重复，或者科学的解释，大脑习得了抽象去除重复的能力，不过两种解释都可以自然的推论出人天性厌恶重复的概念，哲学上来说是先验冲突，科学上来说是大脑厌恶处理重复概念需要花费的额外精力。

(一点题外话，代码的演化基本和信息的丰富所带来的概念演化一致，代码即头脑中概念的投影。为什么我喜欢OO？就是因为OO更容易表示人所理解的概念，而函数式则更面向技术和数学世界)

那么，为何人天性厌恶重复的概念，但有的程序员对重复代码更敏感，有的则不然？我认为，这是对现实世界进行抽象和概念化的能力差异的体现，因为如前所述，人是对重复概念敏感，而不是对重复的代码，所以如果一个人能在代码所体现的结构和层次上看到重复的代码所表征的重复概念，那么他就会产生厌恶感并想法消除这个重复概念，但如果他根本无法看到重复的概念，而只是看到了那些重复的代码字符，恐怕压根就没有厌恶感产生。比如下面的例子：

    class human {
        walk = "两脚行走"
    }

    class dog {
        trained = "两脚行走"
    }

好，资深程序员们，告诉我，你有多么厌恶上面的重复，多想消除这个重复，你觉得消除值得么？

